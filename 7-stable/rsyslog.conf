#
# /etc/rsyslog.conf - global configuration file for syslog clients
#
# Author/maintainer: JÃ¶rgen Maas <jorgen.maas@gmail.com>
# https://github.com/jmaas/logmanagement-rsyslog/7-stable/
#


global(
    # working directory - temp/state files are stored here
    workDirectory="/var/lib/rsyslog"
   
    # truncate messages after 8kb
    maxMessageSize="8k"

    # FIXME: needs testing
    dropMsgsWithMaliciousDNSPtrRecords="off"
    localHostname="off"
    preserveFQDN="on"


    # uncomment to enable TLS syslog
    defaultNetstreamDriver="gtls"
    defaultNetstreamDriverCAFile="/dev/null"
    defaultNetstreamDriverKeyFile="/dev/null"
)


#
# legacy configuration statements - not yet available in rainerscript?!
#

# include all config files in /etc/rsyslog.d/
#
$IncludeConfig /etc/rsyslog.d/*.conf


# drop privileges to the specified user and group (by name)
# though highly recommended, you need to be careful..
# since most distros just run rsyslogd as root these are the
# things to consider:
# - create user/group
# - ownership/permissions of $WorkDirectory
# - ownership/permissions of /var/log
# - log rotation, eg. /etc/logrotate.d configuration
#
#$PrivDropToUser syslog
#$PrivDropToGroup syslog

# EOF
